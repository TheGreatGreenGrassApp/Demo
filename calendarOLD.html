<!DOCTYPE html>
<html>

<head>
    <title>Great Green Grass App</title>
    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <!-- Bootswatch Cosmos -->
    <link rel="stylesheet" type="text/css" href="./assets/CSS/bootswatch.css">
    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="./assets/CSS/style.css">
    <!-- WEATHER JS -->
    <!-- JQUERY -->
</head>

<body>
    <nav class="navbar navbar-default" id="header">
        <div class="container-fluid">
            <!-- LOGO -->
            <div class="navbar-header id="header"">
                <a class="navbar-brand" href="index.html">Great Green Grass</a>
            </div>
            <!-- LINKS TO OTHER PAGES -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="map.html">Map</a></li>
                    <li><a href="calendar.html">Calendar</a></li>
                </ul>
            </div>
        </div>
    </nav>
</body>
<div class="weather-container">
    <div class="row" id="forecast">
        <div class="panel-group">
            <div class="panel panel-default col-md-2 col-md-offset-1">
                <div class="panel-heading" id="0">Panel heading without title</div>
                <div class="panel-body" id="forecast-0">
                <img class="weather-icon-0">
                <div class="well">Temps</div>
                
                </div>
            </div>
            <div class="panel panel-default col-md-2">
                <div class="panel-heading" id="1">Panel heading without title</div>
                <div class="panel-body" id="forecast-1">
                    Panel content
                </div>
            </div>
            <div class="panel panel-default col-md-2">
                <div class="panel-heading" id="2">Panel heading without title</div>
                <div class="panel-body" id="forecast-2">
                    Panel content
                </div>
            </div>
            <div class="panel panel-default col-md-2">
                <div class="panel-heading" id="3">Panel heading without title</div>
                <div class="panel-body" id="forecast-3">
                    Panel content
                </div>
            </div>
            <div class="panel panel-default col-md-2">
                <div class="panel-heading" id="4">Panel heading without title</div>
                <div class="panel-body" id="forecast-4">
                    Panel content
                </div>
            </div>
        </div>
    </div>
</div>
<!-- jQuery -->
<script src="http://code.jquery.com/jquery-2.1.3.min.js"></script>
<!-- moment JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.js"></script>
<!-- JS -->
<script type="text/javascript">
// Weather API key
var APIKey = "23ae7d9312bb6593a2d4d374ce8f4ca0";
var lat = "41.4993";
var long = "81.6944";
var city = "Cleveland";

// Query URL to access weather data
// https://api.darksky.net/forecast/[key]/[latitude],[longitude]
var queryURL = "https://api.darksky.net/forecast/" + APIKey + "/" + lat + "," + long;
console.log(queryURL);

// AJAX call
$.ajax({
    url: queryURL,
    method: "GET",
    jsonp: "callback",
    // Tell jQuery we're expecting JSONP
    dataType: "jsonp",
    // Work with the response
    success: function(response) {
        console.log(response); // server response
        console.log(response.daily);
        console.log(response.daily.data);

        // An array to hold weather data
        var forecastArray = [];

        // For loop to fill weather array with needed data

        for (var i = 0; i < 5; i++) {
            console.log(response.daily.data[i]);

            // Grab only the weather variables we need and push to forecastArray
            forecastArray.push({
                date: moment.unix(response.daily.data[i].time).format("MM/DD/YYYY"),
                min_temp: response.daily.data[i].temperatureMin,
                max_temp: response.daily.data[i].temperatureMax,
                description: response.daily.data[i].summary,
                icon: response.daily.data[i].icon
            });

            console.log(forecastArray);

        } // Close forecast array for loop

        // Append weather data to calendar.html

        for (var i = 0; i < forecastArray.length; i++) {

            // Append date to panel header
            $("#" + i).html(forecastArray[i].date);

            // http://openweathermap.org/img/w/10d.png
            // Create link to weather icon
            var iconLink = "./assets/images/" + forecastArray[i].icon + ".png";

            // Round temperatures       
            minTempF = Math.round(parseInt(forecastArray[i].min_temp));
            maxTempF = Math.round(parseInt(forecastArray[i].max_temp));


            // Create a panel div to hold day's forecast info
            var weatherDiv = "<div class= " + i + "" + "</div>";

            var imgDiv = ("<img src=" + iconLink + "><br>");

            var descDiv = ("<p>" + forecastArray[i].description + "</p>");

            var minDiv = ("<br><p> Min Temp:  " + minTempF + "</p>");
            var maxDiv = ("<p> Max Temp:  " + maxTempF + "</p>");

            // Append the weatherDiv to the panel body
            $("#forecast-" + i).html('');
            $("#forecast-" + i).append(imgDiv, minDiv, maxDiv, descDiv );

        } // Close weather forecast append for loop


    }



}); // Close AJAX Call function
</script>

</html>
